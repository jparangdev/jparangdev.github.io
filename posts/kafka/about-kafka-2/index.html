<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Kafka 알아보기 - 2 | Jparangdev'Blog</title><meta name=keywords content="kafka"><meta name=description content="Kafka 알아보기"><meta name=author content="jparangdev"><link rel=canonical href=https://japarangdev.gitio.com/posts/kafka/about-kafka-2/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.bc435bed1061be2618667408894ae8a5d27c970831ce57f287e42f911918fcbc.css integrity="sha256-vENb7RBhviYYZnQIiUropdJ8lwgxzlfyh+QvkRkY/Lw=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://japarangdev.gitio.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://japarangdev.gitio.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://japarangdev.gitio.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://japarangdev.gitio.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://japarangdev.gitio.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.1"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-123-45','auto'),ga('send','pageview'))</script><meta property="og:title" content="Kafka 알아보기 - 2"><meta property="og:description" content="Kafka 알아보기"><meta property="og:type" content="article"><meta property="og:url" content="https://japarangdev.gitio.com/posts/kafka/about-kafka-2/"><meta property="og:image" content="https://japarangdev.gitio.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-23T14:22:00+09:00"><meta property="article:modified_time" content="2021-01-23T14:22:00+09:00"><meta property="og:site_name" content="Jparangdev's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://japarangdev.gitio.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Kafka 알아보기 - 2"><meta name=twitter:description content="Kafka 알아보기"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://japarangdev.gitio.com/posts/"},{"@type":"ListItem","position":2,"name":"Kafka 알아보기 - 2","item":"https://japarangdev.gitio.com/posts/kafka/about-kafka-2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kafka 알아보기 - 2","name":"Kafka 알아보기 - 2","description":"Kafka 알아보기","keywords":["kafka"],"articleBody":"그럼 이제 실제로 카프카를 한번 설치해보자\nKafka Download URL : https://kafka.apache.org/downloads\n$ mkdir kafka $ cd kafka $ wget https://downloads.apache.org/kafka/2.6.0/kafka_2.12-2.6.0.tgz $ tar -zxvf kafka_2.12-2.6.0.tgz Kafka를 다운로드 받고 압축을 해제.\n압축을 해제한 폴더의 Config폴더로 들어가면 zookeeper.properties 파일이 있다.\nKafka의 메타데이터 관리는 zookeeper가 관리하기 때문에 해당 파일을 통해 설정을 변경 할 수 있다.\n$ cd kafka_2.12-2.6.0 $ mkdir data $ echo 1  myid $ vi myid 미리 zookeeper의 데이터(각 ID)가 저장될 폴더를 생성하자\n/app/kafka/kafka-2.6.0-src/data 에 생성\n# Licensed to the Apache Software Foundation (ASF) under one or more # contributor license agreements. See the NOTICE file distributed with # this work for additional information regarding copyright ownership. # The ASF licenses this file to You under the Apache License, Version 2.0 # (the \"License\"); you may not use this file except in compliance with # the License. You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an \"AS IS\" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # the directory where the snapshot is stored. # 각 서버별 아이디가 저장될 위치를 지정해줍니다. dataDir=/app/kafka/kafka_2.12-2.6.0/data # the port at which the clients will connect clientPort=2181 # disable the per-ip limit on the number of connections since this is a non-production config maxClientCnxns=0 # Disable the adminserver by default to avoid port conflicts. # Set the port to something non-conflicting if choosing to enable this admin.enableServer=false # admin.serverPort=808 # 팔로워 파티션과 리더 파티션이 초기 연결되는 시간제한 설정  initLimit=5 # 팔로워 파티션과 리더 파티션이 동기화 되는 시간의 타임아웃 # 해당시간내에 동기화 되지 않으면 해제된다. syncLimmit=2 # 각각의 Kafka Broker 서버정보 juvis-kafka.1=(첫번째서버 IP):2888:3888 juvis-kafka.2=(두번째서버 IP):2888:3888 dataDir에 생성한 폴더 주소를 입력하고 initLimit,syncLimmit를 입력한 뒤 각 서버 정보를 입력\n자세한 내용은 https://zookeeper.apache.org/ 페이지를 참고하자.\n각각의 서버에서 아까 만들었던 Data폴더 위치에 myid 파일을 만들고 여기에는 각각 아이디의 번호인 1, 2를 입력하자\nmyid 파일에 쓰인 번호는 zookeeper.properties 파일에 쓰인 .1 .2의 아이디와 연결되는 역할을 한다\n이번엔 server.properties 파일을 설정해보자.\nlisteners=PLAINTEXT://:9092 advertised.listeners=PLAINTEXT://192.168.137.101:9092 zookeeper.connect=(첫번째 서버 IP):2181, (두번째 서버 IP):2181, 방화벽도 해재한다.\n## 주키퍼 포트  firewall-cmd --permanent --zone=public --add-port=2181/tcp firewall-cmd --permanent --zone=public --add-port=2888/tcp firewall-cmd --permanent --zone=public --add-port=3888/tcp ## 카프카 포트 firewall-cmd --permanent --zone=public --add-port=9092/tcp 앞서 진행한 작업들은 각 서버마다 연동을 해주기 위한 기본적인 작업이다. 이제 Zookeeper를 먼저 구동후 Kafka를 구동해보자\n기동하려는데 에러 발생.. 원인은 소스파일이아니라 바이너리 파일을 받았어야함..ㅠ 다시 수정해서 위에 진행사항과 동일하게 진행했다.\nClasspath is empty. Please build the project first e.g. by running './gradlew jar -PscalaVersion=2.13.2' 이런 오류가 뜬다…\n$ bin/zookeeper-server-start.sh config/zookeeper.properties $ bin/kafka-server-start.sh config/server.properties zookeeper를 먼저 기동하고 kafka를 기동해야 한다.\n","wordCount":"445","inLanguage":"en","datePublished":"2021-01-23T14:22:00+09:00","dateModified":"2021-01-23T14:22:00+09:00","author":{"@type":"Person","name":"jparangdev"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://japarangdev.gitio.com/posts/kafka/about-kafka-2/"},"publisher":{"@type":"Organization","name":"Jparangdev'Blog","logo":{"@type":"ImageObject","url":"https://japarangdev.gitio.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://japarangdev.gitio.com/ accesskey=h title="Jparangdev :) (Alt + H)">Jparangdev :)</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://japarangdev.gitio.com/archives/ title=Post><span>Post</span></a></li><li><a href=https://japarangdev.gitio.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://japarangdev.gitio.com/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://japarangdev.gitio.com/>Home</a>&nbsp;»&nbsp;<a href=https://japarangdev.gitio.com/posts/>Posts</a></div><h1 class=post-title>Kafka 알아보기 - 2</h1><div class=post-description>Kafka 알아보기</div><div class=post-meta>January 23, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;jparangdev</div></header><div class=post-content><p>그럼 이제 실제로 카프카를 한번 설치해보자</p><p>Kafka Download URL : <a href=https://kafka.apache.org/downloads>https://kafka.apache.org/downloads</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ mkdir kafka
$ cd kafka
$ wget https://downloads.apache.org/kafka/2.6.0/kafka_2.12-2.6.0.tgz
$ tar -zxvf kafka_2.12-2.6.0.tgz
</code></pre></div><p>Kafka를 다운로드 받고 압축을 해제.<br>압축을 해제한 폴더의 Config폴더로 들어가면 zookeeper.properties 파일이 있다.<br>Kafka의 메타데이터 관리는 zookeeper가 관리하기 때문에 해당 파일을 통해 설정을 변경 할 수 있다.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cd kafka_2.12-2.6.0
$ mkdir data
$ echo <span style=color:#ae81ff>1</span> &gt; myid
$ vi myid
</code></pre></div><p>미리 zookeeper의 데이터(각 ID)가 저장될 폴더를 생성하자<br>/app/kafka/kafka-2.6.0-src/data 에 생성</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># Licensed to the Apache Software Foundation (ASF) under one or more</span>
<span style=color:#75715e># contributor license agreements.  See the NOTICE file distributed with</span>
<span style=color:#75715e># this work for additional information regarding copyright ownership.</span>
<span style=color:#75715e># The ASF licenses this file to You under the Apache License, Version 2.0</span>
<span style=color:#75715e># (the &#34;License&#34;); you may not use this file except in compliance with</span>
<span style=color:#75715e># the License.  You may obtain a copy of the License at</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e>#    http://www.apache.org/licenses/LICENSE-2.0</span>
<span style=color:#75715e>#</span>
<span style=color:#75715e># Unless required by applicable law or agreed to in writing, software</span>
<span style=color:#75715e># distributed under the License is distributed on an &#34;AS IS&#34; BASIS,</span>
<span style=color:#75715e># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span style=color:#75715e># See the License for the specific language governing permissions and</span>
<span style=color:#75715e># limitations under the License.</span>
<span style=color:#75715e># the directory where the snapshot is stored.</span>
<span style=color:#75715e># 각 서버별 아이디가 저장될 위치를 지정해줍니다.</span>
dataDir<span style=color:#f92672>=</span>/app/kafka/kafka_2.12-2.6.0/data 
<span style=color:#75715e># the port at which the clients will connect</span>
clientPort<span style=color:#f92672>=</span><span style=color:#ae81ff>2181</span>
<span style=color:#75715e># disable the per-ip limit on the number of connections since this is a non-production config</span>
maxClientCnxns<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
<span style=color:#75715e># Disable the adminserver by default to avoid port conflicts.</span>
<span style=color:#75715e># Set the port to something non-conflicting if choosing to enable this</span>
admin.enableServer<span style=color:#f92672>=</span>false
<span style=color:#75715e># admin.serverPort=808</span>

<span style=color:#75715e># 팔로워 파티션과 리더 파티션이 초기 연결되는 시간제한 설정 </span>
initLimit<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span> 

<span style=color:#75715e># 팔로워 파티션과 리더 파티션이 동기화 되는 시간의 타임아웃</span>
<span style=color:#75715e># 해당시간내에 동기화 되지 않으면 해제된다.</span>
syncLimmit<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>

<span style=color:#75715e># 각각의 Kafka Broker 서버정보</span>
juvis-kafka.1<span style=color:#f92672>=(</span>첫번째서버 IP<span style=color:#f92672>)</span>:2888:3888
juvis-kafka.2<span style=color:#f92672>=(</span>두번째서버 IP<span style=color:#f92672>)</span>:2888:3888
</code></pre></div><p>dataDir에 생성한 폴더 주소를 입력하고 initLimit,syncLimmit를 입력한 뒤 각 서버 정보를 입력<br>자세한 내용은 <a href=https://zookeeper.apache.org/>https://zookeeper.apache.org/</a> 페이지를 참고하자.</p><p>각각의 서버에서 아까 만들었던 Data폴더 위치에 myid 파일을 만들고 여기에는 각각 아이디의 번호인 1, 2를 입력하자<br>myid 파일에 쓰인 번호는 <a href=http://zookeeper.properties>zookeeper.properties</a> 파일에 쓰인 .1 .2의 아이디와 연결되는 역할을 한다</p><p>이번엔 server.properties 파일을 설정해보자.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>listeners<span style=color:#f92672>=</span>PLAINTEXT://:9092

advertised.listeners<span style=color:#f92672>=</span>PLAINTEXT://192.168.137.101:9092

zookeeper.connect<span style=color:#f92672>=(</span>첫번째 서버 IP<span style=color:#f92672>)</span>:2181, <span style=color:#f92672>(</span>두번째 서버 IP<span style=color:#f92672>)</span>:2181, 
</code></pre></div><p>방화벽도 해재한다.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e>## 주키퍼 포트 </span>
firewall-cmd --permanent --zone<span style=color:#f92672>=</span>public --add-port<span style=color:#f92672>=</span>2181/tcp
firewall-cmd --permanent --zone<span style=color:#f92672>=</span>public --add-port<span style=color:#f92672>=</span>2888/tcp
firewall-cmd --permanent --zone<span style=color:#f92672>=</span>public --add-port<span style=color:#f92672>=</span>3888/tcp

<span style=color:#75715e>## 카프카 포트</span>
firewall-cmd --permanent --zone<span style=color:#f92672>=</span>public --add-port<span style=color:#f92672>=</span>9092/tcp
</code></pre></div><p>앞서 진행한 작업들은 각 서버마다 연동을 해주기 위한 기본적인 작업이다.
이제 Zookeeper를 먼저 구동후 Kafka를 구동해보자</p><p>기동하려는데 에러 발생.. 원인은 소스파일이아니라 바이너리 파일을 받았어야함..ㅠ
다시 수정해서 위에 진행사항과 동일하게 진행했다.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>Classpath is empty. Please build the project first e.g. by running <span style=color:#e6db74>&#39;./gradlew jar -PscalaVersion=2.13.2&#39;</span>
</code></pre></div><p>이런 오류가 뜬다&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ bin/zookeeper-server-start.sh config/zookeeper.properties
$ bin/kafka-server-start.sh config/server.properties
</code></pre></div><p>zookeeper를 먼저 기동하고 kafka를 기동해야 한다.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://japarangdev.gitio.com/tags/kafka/>kafka</a></li></ul><nav class=paginav><a class=prev href=https://japarangdev.gitio.com/posts/kafka/about-kafka-1/><span class=title>« Prev Page</span><br><span>Kafka 알아보기 - 1</span></a>
<a class=next href=https://japarangdev.gitio.com/posts/programming/event-driven/><span class=title>Next Page »</span><br><span>Event-driven이 뭐지?</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://japarangdev.gitio.com/>Jparangdev'Blog</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>